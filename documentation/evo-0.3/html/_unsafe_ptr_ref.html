<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Evo C++ Library v0.3: Unsafe Pointer Referencing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Evo C++ Library v0.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Unsafe Pointer Referencing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Some Evo classes use Pointer Referencing to copy without allocating memory, improving performance.</p>
<p>This can be unsafe (dangerous) in certain situations so documentation for classes/methods that do this will have a warning and a link to this page.</p>
<p>When speed is less important these classes/methods may be avoided for maximum safety &ndash; Evo will still be fast!</p>
<dl class="section user"><dt>Definition</dt><dd></dd></dl>
<p>Unsafe Pointer Referencing means an object is using (referencing) a pointer it does not own that may become invalid. If the actual owner frees this pointer then the object referencing it will be invalidated, and dereferencing the pointer will crash. You're safe as long as the object referencing the pointer is cleared/destroyed before the pointer is invalidated. If the pointer is never freed (ex: string literal) then this is always safe.</p>
<dl class="section user"><dt>Methods</dt><dd></dd></dl>
<p>The following classes have certain methods that use this technique:</p>
<ul>
<li><a class="el" href="classevo_1_1_list.html" title="Sequential list container with random access. ">List</a>, <a class="el" href="classevo_1_1_string.html" title="String container. ">String</a></li>
</ul>
<p>This technique is used by method overloads that take a raw pointer:</p>
<ul>
<li>Constructor</li>
<li>operator=</li>
<li>set()</li>
</ul>
<p>Safety:</p>
<ul>
<li>Referencing static data that is never freed is safe<br/>
 Example:<div class="fragment"><div class="line">eov::String str;</div>
<div class="line">str = <span class="stringliteral">&quot;test&quot;</span>; <span class="comment">// Safe!</span></div>
</div><!-- fragment --></li>
<li>Best: Avoid overloads that take a raw pointer, pass <a class="el" href="classevo_1_1_ptr.html" title="Dumb pointer to single object or array. ">Ptr</a> instead (forces an unshared copy)<br/>
 Example:<div class="fragment"><div class="line">eov::String str;</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> buffer[5];</div>
<div class="line">    strcpy(buffer, <span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">    str = Ptr&lt;char&gt;(buffer);    <span class="comment">// Safe (unshared copy)</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Call unshare() after Pointer Reference copy to force an unshared copy<br/>
 Example:<div class="fragment"><div class="line">eov::String str;</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> buffer[5];</div>
<div class="line">    strcpy(buffer, <span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">    str = buffer;   <span class="comment">// Unsafe without next line</span></div>
<div class="line">    str.unshare();  <span class="comment">// Safe (unshared copy)</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Use copy() to force a unshared copy<br/>
 Example:<div class="fragment"><div class="line">eov::String str;</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> buffer[5];</div>
<div class="line">    strcpy(buffer, <span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">    str.copy(buffer);   <span class="comment">// Safe (unshared copy)</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ul>
<dl class="section user"><dt>Classes</dt><dd></dd></dl>
<p>The following classes rely on Pointer Referencing:</p>
<ul>
<li><a class="el" href="structevo_1_1_sub_string.html" title="Reference and access existing string data. ">SubString</a>, <a class="el" href="structevo_1_1_sub_list.html" title="Reference and access existing list data. ">SubList</a>, <a class="el" href="classevo_1_1_ptr.html" title="Dumb pointer to single object or array. ">Ptr</a></li>
</ul>
<p>Safety:</p>
<ul>
<li>Referencing static data that is never freed is safe<br/>
 Example:<div class="fragment"><div class="line">eov::SubString str;</div>
<div class="line">str = <span class="stringliteral">&quot;test&quot;</span>; <span class="comment">// Safe!</span></div>
</div><!-- fragment --></li>
<li>Beware referencing a local buffer with shorter life/scope<br/>
 Example:<div class="fragment"><div class="line">eov::SubString substr;</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> buffer[5];</div>
<div class="line">    strcpy(buffer, <span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">    substr = buffer;    <span class="comment">// BAD!</span></div>
<div class="line">}</div>
<div class="line"><span class="comment">// substr now references an invalid pointer!</span></div>
</div><!-- fragment --></li>
<li>Beware referencing an object with a shorter life/scope<br/>
 Example:<div class="fragment"><div class="line">eov::SubString substr;</div>
<div class="line">{</div>
<div class="line">    String str;</div>
<div class="line">    str.copy(<span class="stringliteral">&quot;testing&quot;</span>);</div>
<div class="line">    substr = str;   <span class="comment">// BAD!</span></div>
<div class="line">}   <span class="comment">// str is destroyed</span></div>
<div class="line"><span class="comment">// substr now references an invalid pointer!</span></div>
</div><!-- fragment --></li>
<li>Beware of modifying (reallocating) an object while it's being referenced<br/>
 Example:<div class="fragment"><div class="line">eov::String str;</div>
<div class="line">str.copy(<span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">eov::SubString substr;</div>
<div class="line">substr = str;</div>
<div class="line">str.copy(<span class="stringliteral">&quot;test123&quot;</span>);    <span class="comment">// BAD! substr now references an invalid pointer since str was reallocated!</span></div>
</div><!-- fragment --></li>
<li>Classes that support Sharing with each other (<a class="el" href="classevo_1_1_list.html" title="Sequential list container with random access. ">List</a>, <a class="el" href="classevo_1_1_string.html" title="String container. ">String</a>) are safe to copy and modify in any order<br/>
 Example:<div class="fragment"><div class="line">eov::String str1;</div>
<div class="line">str1.copy(<span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">String str2(str1);      <span class="comment">// str1 and str2 safely Share same data</span></div>
<div class="line">str1.copy(<span class="stringliteral">&quot;test123&quot;</span>);   <span class="comment">// Safe since Sharing covers modifications on either side</span></div>
</div><!-- fragment --> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 29 2016 02:21:21 for Evo C++ Library v0.3 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
