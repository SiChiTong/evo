<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Evo C++ Library v0.3: Managed Pointers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Evo C++ Library v0.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Managed Pointers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A managed pointer is a class that emulates a raw (built-in) pointer type.</p>
<p>Using managed pointers makes the intent and ownership of the pointer clear and reduces risk of pointer misuse and memory bugs.</p>
<ul>
<li><a class="el" href="classevo_1_1_smart_ptr.html" title="Smart pointer to single object. ">SmartPtr</a> is a smart pointer to a single object, meaning it takes ownership of a pointer and is responsible for freeing it.<ul>
<li>Copying a <a class="el" href="classevo_1_1_smart_ptr.html" title="Smart pointer to single object. ">SmartPtr</a> copies the pointed object too.</li>
</ul>
</li>
<li><a class="el" href="classevo_1_1_shared_ptr.html" title="Shared smart pointer to single object. ">SharedPtr</a> is similar to <a class="el" href="classevo_1_1_smart_ptr.html" title="Smart pointer to single object. ">SmartPtr</a> except it can be shared among multiple owners and uses Reference Counting.<ul>
<li>Copying a <a class="el" href="classevo_1_1_shared_ptr.html" title="Shared smart pointer to single object. ">SharedPtr</a> makes a shared copy (increments reference count) &ndash; all copies share the same instance.</li>
</ul>
</li>
<li><a class="el" href="classevo_1_1_ptr.html" title="Dumb pointer to single object or array. ">Ptr</a> is a dumb pointer to a single object or array, meaning it only references the pointer and does not take ownership. This is useful to indicate the pointer is owned elsewhere.<ul>
<li>One could use raw pointers as dumb pointers, however keep in mind that Evo containers copy differently from a raw pointer vs a managed pointer &ndash; raw pointers may be considered immutable and "referenced", see <a class="el" href="_sharing.html">Sharing</a></li>
<li>Raw pointers are best used only for memory that is both static and immutable, such as string literals</li>
</ul>
</li>
</ul>
<p>All managed pointers are specialized for array types (<code>T[]</code>) to use <code>delete[]</code> to free memory (when applicable). Managed array pointers can't make a copy of the pointed objects (array size not known).</p>
<ul>
<li><a class="el" href="classevo_1_1_smart_ptr_3_01_t[]_4.html">SmartPtr&lt;T[]&gt;</a> (array version) cannot be copied</li>
<li><a class="el" href="classevo_1_1_shared_ptr_3_01_t[]_00_01_t_size_01_4.html">SharedPtr&lt;T[]&gt;</a> (array version) doesn't support unshare()</li>
</ul>
<p>Managed pointers should be used instead of raw pointers as much as possible. Dereference operators (operator*, operator-&gt;, operator[]) are overloaded so they work like raw pointers.</p>
<dl class="section user"><dt>Quick Example</dt><dd></dd></dl>
<div class="fragment"><div class="line"><span class="comment">// Smart pointer to int</span></div>
<div class="line">SmartPtr&lt;int&gt; num(<span class="keyword">new</span> <span class="keywordtype">int</span>);</div>
<div class="line">(*num) = 1; <span class="comment">// parenthesis not required, only used to work around doxygen formatting bug</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Smart pointer to char array</span></div>
<div class="line">SmartPtr&lt;char[]&gt; chars(<span class="keyword">new</span> <span class="keywordtype">char</span>[5]);</div>
<div class="line">strcpy(chars.ptr(), <span class="stringliteral">&quot;test&quot;</span>);</div>
<div class="line">chars[0] = <span class="charliteral">&#39;b&#39;</span>;</div>
</div><!-- fragment --><dl class="section user"><dt>Detailed Example</dt><dd></dd></dl>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ptr_8h.html">evo/ptr.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span>evo;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Example class/object</span></div>
<div class="line"><span class="keyword">struct </span>Data {</div>
<div class="line">    <span class="keywordtype">int</span> val;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// Uses dumb Ptr so it&#39;s clear this function does not take pointer ownership</span></div>
<div class="line"><span class="keywordtype">void</span> print(<a class="code" href="classevo_1_1_ptr.html">Ptr&lt;Data&gt;</a> ptr) {</div>
<div class="line">    <span class="keywordflow">if</span> (ptr) <span class="comment">// managed pointers use SafeBool for easy not-null check</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Val: %i\n&quot;</span>, ptr-&gt;val);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="comment">// Smart pointer</span></div>
<div class="line">    <a class="code" href="classevo_1_1_smart_ptr.html">SmartPtr&lt;Data&gt;</a> ptr(<span class="keyword">new</span> Data);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Set a value, dereference like normal pointer (3 different examples here)</span></div>
<div class="line">    ptr-&gt;val   = 1;</div>
<div class="line">    ptr[0].val = 1;</div>
<div class="line">    (*ptr).val = 1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Pass pointer to a function</span></div>
<div class="line">    print(ptr);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// New scope, use dumb pointer, change value</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Dumb pointer referencing ptr</span></div>
<div class="line">        <a class="code" href="classevo_1_1_ptr.html">Ptr&lt;Data&gt;</a> ptr2;</div>
<div class="line">        ptr2 = ptr;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Change value, pass to function</span></div>
<div class="line">        ptr2-&gt;val = 2;</div>
<div class="line">        print(ptr2);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Transfer ownership for fun</span></div>
<div class="line">    <a class="code" href="classevo_1_1_smart_ptr.html">SmartPtr&lt;Data&gt;</a> ptr2(ptr.<a class="code" href="classevo_1_1_ptr.html#af982c7b7d04185c2d67db76359a60a2c">detach</a>());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Get a raw pointer for fun, pass to function</span></div>
<div class="line">    Data* ptr3 = ptr2.<a class="code" href="structevo_1_1_ptr_base.html#afc480ddcdd112bbeca366a5ae623b920">ptr</a>();</div>
<div class="line">    print(ptr3);</div>
<div class="line">} <span class="comment">// ptr is null, ptr2 automatically freed</span></div>
</div><!-- fragment --><p>Output </p>
<pre class="fragment">Val: 1
Val: 2
Val: 2
</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 29 2016 02:21:21 for Evo C++ Library v0.3 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
